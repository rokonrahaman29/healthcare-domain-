# AI Public Health Assistant
A Streamlit app that provides an AI-driven public health chatbot with SMS simulation, image symptom analysis (via Google Gemini), nearby services lookup (simulated), map visualization, and emergency assistance features

## Table of Contents

* [Features](#features)
* [Prerequisites](#prerequisites)
* [Environment variables](#environment-variables)
* [Installation](#installation)
* [How to run](#how-to-run)
* [Project structure](#project-structure)
* [Dependencies (requirements.txt)](#dependencies-requirementstxt)
* [Gemini (Google Generative AI) configuration](#gemini-configuration)
* [Map & Geolocation behavior](#map--geolocation-behavior)
* [SMS simulation](#sms-simulation)
* [Security & Privacy](#security--privacy)
* [Troubleshooting & common errors](#troubleshooting--common-errors)
* [Extending the app](#extending-the-app)
* [License](#license)

---

## Features

* Chat-based health assistant powered by Google Gemini model (via `google-generativeai` integration).
* Image upload and symptom analysis using the Gemini image capabilities (image bytes are sent to the model).
* Nearby hospitals and pharmacies (simulated realistic data) with distance, phone numbers, and ratings.
* Folium-based map visualization showing user location and nearby services.
* Emergency assistance flow (simulated), emergency numbers, and first-aid instructions generated by Gemini.
* SMS sending/receiving simulation (logs stored in session state). Real SMS requires integration with a gateway (Twilio, Nexmo, etc.).

---

## Prerequisites

* Python 3.10+ (3.11 recommended)
* `pip` or `poetry` for dependency installation
* A Google API key with access to the Generative AI / Gemini APIs (configured as `GOOGLE_API_KEY` in `.env`)
* Optional: An SMS provider account (e.g., Twilio) if you want to replace the SMS simulation with a real gateway

---

## Environment variables

Create a `.env` file in the project root (do not commit this file to source control). Example `.env`:

```
GOOGLE_API_KEY=AIza...YOUR_KEY_HERE
# Optional (for real SMS integration)
TWILIO_ACCOUNT_SID=ACxxxxxxxxxxxx
TWILIO_AUTH_TOKEN=yyyyyyyyyyyy
TWILIO_FROM_NUMBER=+1234567890
```

> Note: The README and app expect a `GOOGLE_API_KEY` environment variable. The app uses `python-dotenv` (`load_dotenv()`) to load variables from `.env`.

---

## Installation

1. Clone the repository:

```bash
git clone <your-repo-url>
cd <your-repo-folder>
```

2. Create and activate a virtual environment:

```bash
python -m venv .venv
# macOS / Linux
source .venv/bin/activate
# Windows (PowerShell)
.\.venv\Scripts\Activate.ps1
```

3. Install dependencies:

```bash
pip install -r requirements.txt
```

---

## How to run

```bash
streamlit run app.py
```

Open the local URL printed by Streamlit (typically `http://localhost:8501`) in your browser.

---

## Project structure (example)

```
.
├── app.py                 # Main Streamlit app (your provided code)
├── README.md              # This README
├── requirements.txt       # Python dependencies
├── .env                   # Environment variables (not committed)
├── assets/                # Static images, icons, sample data
└── utils/                 # Optional helper modules
    └── sms_gateway.py     # Example real SMS gateway integration (optional)
```

---

## Dependencies (requirements.txt)

Below is a recommended `requirements.txt`. Pin versions as needed for reproducibility.

```
streamlit>=1.24.0
google-generativeai>=0.1.0
python-dotenv>=1.0.0
pandas>=1.5.0
numpy>=1.23.0
Pillow>=9.0.0
requests>=2.28.0
folium>=0.14.0
streamlit-folium>=0.11.0
geopy>=2.4.0
geocoder>=1.38.1
```

If you use a real SMS gateway like Twilio, add:

```
twilio>=8.0.0
```

---

## Gemini (Google Generative AI) configuration

* The app expects `GOOGLE_API_KEY` to be set in the environment.
* The code calls `genai.configure(api_key=api_key)` and constructs a `GenerativeModel` instance.
* Model name used in the app: `gemini-1.5-flash` (adjustable).

**Important:** Keep the API key secret. Monitor usage and billing in the Google Cloud console.

---

## Map & Geolocation behavior

* The app supports two location modes:

  * **Auto-detect** using `geocoder.ip('me')` (IP-based location — may be approximate).
  * **Manual Entry** by address using `geopy.Nominatim`.
* Nearby hospital/pharmacy data is simulated — addresses, distances, and phone numbers are generated for demo purposes.
* The app uses `folium` and `streamlit-folium` to render an interactive map inside Streamlit.

---

## SMS simulation

* SMS sending is simulated via `simulate_sms_send()` which validates phone numbers and stores messages to `st.session_state.sms_log`.
* To integrate with a real SMS provider (e.g., Twilio), replace `simulate_sms_send()` with a function that calls the provider API and updates the log accordingly.
* The app includes simple parsing of incoming messages (commands like `INFO`, `LOCATE`, `HELP`, etc.) via `process_incoming_sms()`.

---

## Security & Privacy

* **Do not** hardcode API keys or sensitive credentials in source code. Use environment variables.
* Uploaded images are processed in memory (via PIL) and not persisted by default. If you change this behavior, ensure secure storage and retention policies.
* The assistant provides information only — add clear disclaimers (already present in UI) that it is not a replacement for medical professionals.

---

## Troubleshooting & common errors

* **`GEMINI_API_KEY not found`**: Ensure `.env` exists and contains `GOOGLE_API_KEY`. Restart the app after editing `.env`.
* **`geocoder.ip('me')` returns no location**: IP-based geolocation can fail behind VPNs or privacy networks. Use Manual Entry as fallback.
* **Map rendering errors**: Make sure `streamlit-folium` and `folium` are installed and that `user_lat_lng` is a valid `(lat, lng)` tuple.
* **Image analysis errors**: Verify the Gemini model is configured correctly, uploaded images are valid, and you are following the model's image size limits and mime types.
* **SMS not delivering**: Remember SMS is simulated. If using Twilio, ensure credentials and sandbox/phone verification are correct.

---

## Extending the app (ideas)

* Replace simulated hospital/pharmacy data with real POI data from Google Places API, OpenStreetMap / Nominatim, or Foursquare.
* Add authentication (Streamlit OAuth, Auth0) for protected access.
* Integrate a real SMS gateway (Twilio, MessageBird) for production SMS sending/receiving.
* Add logging and persistent storage for chat logs and SMS logs (e.g., a small SQLite DB or a cloud DB).
* Add rate-limiting and cost controls for API calls to Gemini.

---



FROM python:3.11-slim
WORKDIR /app
COPY . /app
RUN python -m pip install --upgrade pip
RUN pip install -r requirements.txt
EXPOSE 8501
CMD ["streamlit", "run", "app.py", "--server.port=8501", "--server.headless=true"]


Build and run:


docker build -t ai-health-assistant .
docker run -p 8501:8501 --env-file .env ai-health-assistant





requirements.txt


streamlit>=1.24.0
google-generativeai>=0.1.0
python-dotenv>=1.0.0
pandas>=1.5.0
numpy>=1.23.0
Pillow>=9.0.0
requests>=2.28.0
folium>=0.14.0
streamlit-folium>=0.11.0
geopy>=2.4.0
geocoder>=1.38.1
opeanai

